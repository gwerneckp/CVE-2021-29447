# CVE-2021-29447
## Overview
This repository contains a Proof of Concept (PoC) script for exploiting a XML parsing issue in the ID3 audio parsing library, used by WordPress. The vulnerability allows authenticated to upload modified WAVE files to perform XML External Entity (XXE) attacks, which can lead to further Server Side Request Forgery (SSRF) and Remote File Inclusion (RFI) attacks.

## Requirements
- Python 3
- Node.js
- Php

## Setup
Setup a virtual environment with `virtualenv` if you don't want this script polluting your dependencies.
```bash
python3 setup.py
```  

## Usage
Run python3 exploit.py with the following arguments:

- -u or --url: The target URL
- -l or --lhost: The attacker's IP address
- -p or --lport (default=8001): The attacker's port
- -cH or --cookie-hash: The hash used in Wordpress cookies
- -cW or --cookie-wordpress: The cookie of the Wordpress session (wordpress_[hash])
- -cL or --cookie-logged: The cookie of the logged session (wordpress_logged_in_[hash])
- -n or --nonce: The nonce of the Wordpress session
- -pr or --proxy (default=None): The proxy to use (http://host:port)

The script will first generate the malicious WAVE.

It will then open an interactive prompt that will get file paths and insert into the `evil.dtd` file. It will then upload the WAVE file triggering a request to our local `evil.dtd` file, and further triggering a remote file inclusion which will be sent back encoded in the `p` paremeter of the `response` route.

The script will then decode and print the file obtained from the XXE attack.

## Note
Please use this script only for testing and educational purposes and always obtain written permission before testing any exploit on any target.